Following "Monads for functional programming" by Philip Wadler